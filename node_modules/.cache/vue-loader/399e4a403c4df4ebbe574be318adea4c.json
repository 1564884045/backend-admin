{"remainingRequest":"G:\\RQDL\\base\\backend-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\RQDL\\base\\backend-admin\\src\\views\\conf\\config-poster.vue?vue&type=script&lang=js&","dependencies":[{"path":"G:\\RQDL\\base\\backend-admin\\src\\views\\conf\\config-poster.vue","mtime":1620715077855},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQoNCmltcG9ydCBJbWFnZXNVcGxvYWQgZnJvbSAiQC9jb21wb25lbnRzL0ltYWdlc1VwbG9hZCI7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgICBuYW1lOiAiY29uZmlnLXBvc3RlciIsDQogICAgY29tcG9uZW50czoge0ltYWdlc1VwbG9hZH0sDQogICAgZGF0YSgpIHsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGxvYWRpbmc6IGZhbHNlLA0KICAgICAgICAgICAgc2hhcmVJbmZvOiB7DQogICAgICAgICAgICAgICAgY292ZXI6ICIiLA0KICAgICAgICAgICAgICAgIGxvZ29zOiBbXSwNCiAgICAgICAgICAgICAgICBwb3N0ZXJBcnI6IFtdLA0KICAgICAgICAgICAgICAgIHRpdGxlOiAiIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB1cGxvYWRVcmw6ICcnLA0KICAgICAgICAgICAgZGlhbG9nSW1hZ2VVcmw6ICcnLA0KICAgICAgICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsDQogICAgICAgICAgICB1cGxvYWRGaWxlTGlzdDogW10NCiAgICAgICAgfQ0KICAgIH0sDQogICAgY3JlYXRlZCgpIHsNCiAgICAgICAgdGhpcy51cGxvYWRVcmwgPSB0aGlzLiRhcGkuYmFzZVVybCArICcvdXBsb2FkLycgKyB0aGlzLiRzdG9yZS5zdGF0ZS5zaG9wLmlkICsgJy9zaGFyZSc7DQogICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7DQogICAgICAgIHRoaXMuJGFwaS5nZXQoImNvbXBhbnkvY29uZiIpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gMjAwKSB7DQogICAgICAgICAgICAgICAgdGhpcy5zaGFyZUluZm8gPSBKU09OLnBhcnNlKHJlcy5kYXRhLnNoYXJlSW5mbykgfHwgew0KICAgICAgICAgICAgICAgICAgICBjb3ZlcjogIiIsDQogICAgICAgICAgICAgICAgICAgIGxvZ286ICIiLA0KICAgICAgICAgICAgICAgICAgICBwb3N0ZXJBcnI6IFtdLA0KICAgICAgICAgICAgICAgICAgICB0aXRsZTogIiIsDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICBpZiAodGhpcy5zaGFyZUluZm8gJiYgdGhpcy5zaGFyZUluZm8ucG9zdGVyQXJyKSB7DQogICAgICAgICAgICAgICAgICAgIGxldCBfcGF0aEFyciA9IHRoaXMuc2hhcmVJbmZvLnBvc3RlckFyciB8fCBbXTsNCiAgICAgICAgICAgICAgICAgICAgbGV0IF9zaG93TGlzdCA9IFtdOw0KICAgICAgICAgICAgICAgICAgICBfcGF0aEFyci5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgX3Nob3dMaXN0LnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdGhpcy4kYXBpLmJhc2VVcmwgKyBpdGVtLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6IGl0ZW0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnVwbG9hZEZpbGVMaXN0ID0gX3Nob3dMaXN0Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOw0KICAgICAgICB9KS5jYXRjaChlcnIgPT4gew0KICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7DQogICAgICAgIH0pDQoNCiAgICB9LA0KICAgIG1ldGhvZHM6IHsNCiAgICAgICAgc2F2ZSgpIHsNCiAgICAgICAgICAgIGxldCBfbGlzdCA9IHRoaXMuJHJlZnMudXBsb2FkUG9zdGVyLnVwbG9hZEZpbGVzOw0KICAgICAgICAgICAgY29uc29sZS5sb2coX2xpc3QpOw0KICAgICAgICAgICAgbGV0IF9wYXRoQXJyID0gW107DQogICAgICAgICAgICBfbGlzdC5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICAgICAgICAgIGxldCByZXMgPSBpdGVtLnJlc3BvbnNlOw0KICAgICAgICAgICAgICAgIGlmIChyZXMgJiYgMjAwID09PSBOdW1iZXIucGFyc2VJbnQocmVzLmNvZGUpKSB7DQogICAgICAgICAgICAgICAgICAgIF9wYXRoQXJyLnB1c2gocmVzLmRhdGEucGF0aCkNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBfcGF0aEFyci5wdXNoKGl0ZW0ucGF0aCkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIHRoaXMuc2hhcmVJbmZvLnBvc3RlckFyciA9IF9wYXRoQXJyOw0KICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5zaGFyZUluZm8pOw0KDQogICAgICAgICAgICBsZXQgcG9zdERhdGEgPSB7DQogICAgICAgICAgICAgICAgc2hhcmVJbmZvOiBKU09OLnN0cmluZ2lmeSh0aGlzLnNoYXJlSW5mbykNCiAgICAgICAgICAgIH07DQogICAgICAgICAgICAvLyDmm7TmlrDmlbDmja4NCiAgICAgICAgICAgIHRoaXMuc2F2ZUNvbmYocG9zdERhdGEpDQogICAgICAgIH0sDQogICAgICAgIHNhdmVDb25mKGNvbmYpIHsNCiAgICAgICAgICAgIHRoaXMuJGFwaS5wb3N0KCJjb21wYW55L2NvbmYiLCBjb25mKS50aGVuKHJldCA9PiB7DQogICAgICAgICAgICAgICAgaWYgKHJldC5jb2RlID09PSAyMDApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXQubXNnKTsNCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmV0Lm1zZyk7DQogICAgICAgICAgICB9KQ0KICAgICAgICB9LA0KICAgICAgICBoYW5kbGVSZW1vdmUoZmlsZSwgZmlsZUxpc3QpIHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGZpbGUsIGZpbGVMaXN0KTsNCiAgICAgICAgfSwNCiAgICAgICAgaGFuZGxlUGljdHVyZUNhcmRQcmV2aWV3KGZpbGUpIHsNCiAgICAgICAgICAgIHRoaXMuZGlhbG9nSW1hZ2VVcmwgPSBmaWxlLnVybDsNCiAgICAgICAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWU7DQogICAgICAgIH0NCiAgICB9DQp9DQo="},{"version":3,"sources":["config-poster.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"config-poster.vue","sourceRoot":"src/views/conf","sourcesContent":["<template>\r\n    <!--  图文配置  -->\r\n    <el-card class=\"box-card\" v-loading=\"loading\"\r\n             element-loading-text=\"拼命加载中\"\r\n             element-loading-spinner=\"el-icon-loading\"\r\n             element-loading-background=\"rgba(0, 0, 0, 0.9)\">\r\n        <div slot=\"header\" class=\"clearfix\"><span>分享图文</span>\r\n        </div>\r\n        <el-form ref=\"form\" :model=\"shareInfo\" label-width=\"260px\">\r\n            <el-form-item label=\"分享默认标题\" prop=\"accessKey\">\r\n                <el-input type=\"text\" v-model=\"shareInfo.title\"\r\n                          placeholder=\"页面未设置分享时默认的分享标题\"/>\r\n            </el-form-item>\r\n\r\n            <el-form-item label=\"封面展示（默认分享图片）：\">\r\n                <image-upload v-model=\"shareInfo\" field=\"cover\" :action=\"uploadUrl\"/>\r\n            </el-form-item>\r\n            <el-form-item label=\"logo：\">\r\n                <images-upload v-model=\"shareInfo\" field=\"logos\" :action=\"uploadUrl\"/>\r\n            </el-form-item>\r\n            <el-form-item label=\"海报图片集：\">\r\n                <images-upload :max=\"6\" v-model=\"shareInfo\" field=\"posterArr\" :action=\"uploadUrl\"/>\r\n            </el-form-item>\r\n            <el-form-item>\r\n                <el-alert title=\"修改后点击下方保存按钮生效\" type=\"info\" show-icon :closable=\"false\"/>\r\n            </el-form-item>\r\n            <el-form-item>\r\n                <el-button type=\"primary\" @click=\"save\">立即保存</el-button>\r\n            </el-form-item>\r\n        </el-form>\r\n    </el-card>\r\n</template>\r\n\r\n<script>\r\n\r\nimport ImagesUpload from \"@/components/ImagesUpload\";\r\n\r\nexport default {\r\n    name: \"config-poster\",\r\n    components: {ImagesUpload},\r\n    data() {\r\n        return {\r\n            loading: false,\r\n            shareInfo: {\r\n                cover: \"\",\r\n                logos: [],\r\n                posterArr: [],\r\n                title: \"\",\r\n            },\r\n            uploadUrl: '',\r\n            dialogImageUrl: '',\r\n            dialogVisible: false,\r\n            uploadFileList: []\r\n        }\r\n    },\r\n    created() {\r\n        this.uploadUrl = this.$api.baseUrl + '/upload/' + this.$store.state.shop.id + '/share';\r\n        this.loading = true;\r\n        this.$api.get(\"company/conf\").then(res => {\r\n            if (res.code === 200) {\r\n                this.shareInfo = JSON.parse(res.data.shareInfo) || {\r\n                    cover: \"\",\r\n                    logo: \"\",\r\n                    posterArr: [],\r\n                    title: \"\",\r\n                };\r\n                if (this.shareInfo && this.shareInfo.posterArr) {\r\n                    let _pathArr = this.shareInfo.posterArr || [];\r\n                    let _showList = [];\r\n                    _pathArr.forEach(item => {\r\n                        _showList.push({\r\n                            url: this.$api.baseUrl + item,\r\n                            path: item\r\n                        })\r\n                    });\r\n                    this.uploadFileList = _showList;\r\n                }\r\n            }\r\n            this.loading = false;\r\n        }).catch(err => {\r\n            this.loading = false;\r\n        })\r\n\r\n    },\r\n    methods: {\r\n        save() {\r\n            let _list = this.$refs.uploadPoster.uploadFiles;\r\n            console.log(_list);\r\n            let _pathArr = [];\r\n            _list.forEach(item => {\r\n                let res = item.response;\r\n                if (res && 200 === Number.parseInt(res.code)) {\r\n                    _pathArr.push(res.data.path)\r\n                } else {\r\n                    _pathArr.push(item.path)\r\n                }\r\n            });\r\n            this.shareInfo.posterArr = _pathArr;\r\n            console.log(this.shareInfo);\r\n\r\n            let postData = {\r\n                shareInfo: JSON.stringify(this.shareInfo)\r\n            };\r\n            // 更新数据\r\n            this.saveConf(postData)\r\n        },\r\n        saveConf(conf) {\r\n            this.$api.post(\"company/conf\", conf).then(ret => {\r\n                if (ret.code === 200)\r\n                    this.$message.success(ret.msg);\r\n                else\r\n                    this.$message.error(ret.msg);\r\n            })\r\n        },\r\n        handleRemove(file, fileList) {\r\n            console.log(file, fileList);\r\n        },\r\n        handlePictureCardPreview(file) {\r\n            this.dialogImageUrl = file.url;\r\n            this.dialogVisible = true;\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"]}]}