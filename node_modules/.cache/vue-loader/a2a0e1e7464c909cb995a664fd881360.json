{"remainingRequest":"G:\\RQDL\\base\\backend-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\RQDL\\base\\backend-admin\\src\\views\\user\\components\\chatBox.vue?vue&type=style&index=0&id=4bd19418&scoped=true&lang=css&","dependencies":[{"path":"G:\\RQDL\\base\\backend-admin\\src\\views\\user\\components\\chatBox.vue","mtime":1620715077891},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKPj4+IC5lbC1jYXJkX19ib2R5IHsKICAgIHBhZGRpbmc6IDA7Cn0KCi5zaGFkb3cgewogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgdG9wOiAwOwogICAgbGVmdDogMDsKICAgIHotaW5kZXg6IDEwMDsKICAgIHdpZHRoOiAxMDAlOwogICAgaGVpZ2h0OiAxMDAlOwogICAgYmFja2dyb3VuZDogIzAwMDsKICAgIG9wYWNpdHk6IC4yOwp9Cgoud2luZG93IHsKICAgIG1pbi13aWR0aDogMzAwcHg7CiAgICBiYWNrZ3JvdW5kOiAjRjVGNUY1OwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIHBhZGRpbmc6IDA7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB6LWluZGV4OiAxMDE7Cn0KCi53MTAwIHsKICAgIHdpZHRoOiAxMDAlOwp9CgoubXQ1IHsKICAgIG1hcmdpbi10b3A6IDVweDsKfQoKLm10MTAgewogICAgbWFyZ2luLXRvcDogMTBweDsKfQoKLm10MjAgewogICAgbWFyZ2luLXRvcDogMjBweDsKfQoKLm1iMTAgewogICAgbWFyZ2luLWJvdHRvbTogMTBweDsKfQoKLm1iMjAgewogICAgbWFyZ2luLWJvdHRvbTogMjBweDsKfQoKLmZzMCB7CiAgICBmb250LXNpemU6IDAKfQoKLnRpdGxlIHsKICAgIGJhY2tncm91bmQ6ICMwMDA7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICBjb2xvcjogI2ZmZjsKICAgIHdpZHRoOiAxMDAlOwogICAgaGVpZ2h0OiA1MHB4OwogICAgbGluZS1oZWlnaHQ6IDUwcHg7CiAgICBmb250LXNpemU6IDE0cHg7Cn0KCi5sb2FkaW5nLCAubm8tbW9yZSB7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICBjb2xvcjogI2IwYjBiMDsKICAgIGxpbmUtaGVpZ2h0OiAxMDBweDsKfQoKLm5vLW1vcmUgewogICAgbGluZS1oZWlnaHQ6IDYwcHg7Cn0KCi5wdWxsLXJpZ2h0IHsKICAgIGZsb2F0OiByaWdodDsKfQoKLmxpbmstbGluZSB7CiAgICB0ZXh0LWRlY29yYXRpb246IHVuZGVybGluZTsKfQoKLm1lc3NhZ2UgewogICAgLypoZWlnaHQ6IDEwMCU7Ki8KICAgIHBhZGRpbmc6IDEwcHggMTVweDsKICAgIC8qb3ZlcmZsb3cteTogc2Nyb2xsOyovCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRjVGNUY1Owp9CgoubWVzc2FnZSBsaSB7CiAgICBtYXJnaW4tYm90dG9tOiAxNXB4OwogICAgbGVmdDogMDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIGRpc3BsYXk6IGJsb2NrOwp9CgoubWVzc2FnZSAudGltZSB7CiAgICBtYXJnaW46IDEwcHggMDsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKfQoKLm1lc3NhZ2UgLnRleHQgewogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgbWF4LXdpZHRoOiBjYWxjKDEwMCUgLSA3NXB4KTsKICAgIG1pbi1oZWlnaHQ6IDM1cHg7CiAgICBsaW5lLWhlaWdodDogMi4xOwogICAgZm9udC1zaXplOiAxNXB4OwogICAgcGFkZGluZzogNnB4IDEwcHg7CiAgICB0ZXh0LWFsaWduOiBsZWZ0OwogICAgd29yZC1icmVhazogYnJlYWstYWxsOwogICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsKICAgIGNvbG9yOiAjMDAwOwogICAgYm9yZGVyLXJhZGl1czogNHB4OwogICAgYm94LXNoYWRvdzogMHB4IDFweCA3cHggLTVweCAjMDAwOwp9CgoubWVzc2FnZSAuYXZhdGFyIHsKICAgIGZsb2F0OiBsZWZ0OwogICAgbWFyZ2luOiAwIDEwcHggMCAwOwp9CgoubWVzc2FnZSAudGltZSA+IHNwYW4gewogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgcGFkZGluZzogMCA1cHg7CiAgICBmb250LXNpemU6IDEycHg7CiAgICBjb2xvcjogI2ZmZjsKICAgIGJvcmRlci1yYWRpdXM6IDJweDsKICAgIGJhY2tncm91bmQtY29sb3I6ICNEQURBREE7Cn0KCi5tZXNzYWdlIC5zeXN0ZW0gPiBzcGFuIHsKICAgIHBhZGRpbmc6IDRweCA5cHg7CiAgICB0ZXh0LWFsaWduOiBsZWZ0Owp9CgoubWVzc2FnZSAudGV4dDpiZWZvcmUgewogICAgY29udGVudDogIiAiOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgdG9wOiA5cHg7CiAgICByaWdodDogMTAwJTsKICAgIGJvcmRlcjogNnB4IHNvbGlkIHRyYW5zcGFyZW50OwogICAgYm9yZGVyLXJpZ2h0LWNvbG9yOiAjZmZmOwp9CgoubWVzc2FnZSAuc2VsZiB7CiAgICB0ZXh0LWFsaWduOiByaWdodDsKfQoKLm1lc3NhZ2UgLnNlbGYgLmF2YXRhciB7CiAgICBmbG9hdDogcmlnaHQ7CiAgICBtYXJnaW46IDAgMCAwIDEwcHg7Cn0KCi5tZXNzYWdlIC5zZWxmIC50ZXh0IHsKICAgIGJhY2tncm91bmQtY29sb3I6ICM5RUVBNkE7Cn0KCi5tZXNzYWdlIC5zZWxmIC50ZXh0OmJlZm9yZSB7CiAgICByaWdodDogaW5oZXJpdDsKICAgIGxlZnQ6IDEwMCU7CiAgICBib3JkZXItcmlnaHQtY29sb3I6IHRyYW5zcGFyZW50OwogICAgYm9yZGVyLWxlZnQtY29sb3I6ICM5RUVBNkE7Cn0KCi5tZXNzYWdlIC5pbWFnZSB7CiAgICBtYXgtd2lkdGg6IDIwMHB4Owp9CgppbWcuc3RhdGljLWVtb3Rpb24tZ2lmLCBpbWcuc3RhdGljLWVtb3Rpb24gewogICAgdmVydGljYWwtYWxpZ246IG1pZGRsZSAhaW1wb3J0YW50Owp9CgouYW4tbW92ZS1sZWZ0IHsKICAgIGxlZnQ6IDA7CiAgICBhbmltYXRpb246IG1vdmVMZWZ0IC43cyBlYXNlOwogICAgLXdlYmtpdC1hbmltYXRpb246IG1vdmVMZWZ0IC43cyBlYXNlOwp9CgouYW4tbW92ZS1yaWdodCB7CiAgICBsZWZ0OiAwOwogICAgYW5pbWF0aW9uOiBtb3ZlUmlnaHQgLjdzIGVhc2U7CiAgICAtd2Via2l0LWFuaW1hdGlvbjogbW92ZVJpZ2h0IC43cyBlYXNlOwp9CgouYmdub25lIHsKICAgIGJhY2tncm91bmQ6IG5vbmU7Cn0KCkBrZXlmcmFtZXMgbW92ZVJpZ2h0IHsKICAgIDAlIHsKICAgICAgICBsZWZ0OiAtMzBweDsKICAgICAgICBvcGFjaXR5OiAwCiAgICB9CiAgICAxMDAlIHsKICAgICAgICBsZWZ0OiAwOwogICAgICAgIG9wYWNpdHk6IDEKICAgIH0KfQoKQC13ZWJraXQta2V5ZnJhbWVzIG1vdmVSaWdodCB7CiAgICAwJSB7CiAgICAgICAgbGVmdDogLTUwcHg7CiAgICAgICAgb3BhY2l0eTogMAogICAgfQogICAgMTAwJSB7CiAgICAgICAgbGVmdDogMHB4OwogICAgICAgIG9wYWNpdHk6IDEKICAgIH0KfQoKQGtleWZyYW1lcyBtb3ZlTGVmdCB7CiAgICAwJSB7CiAgICAgICAgbGVmdDogMjBweDsKICAgICAgICBvcGFjaXR5OiAwCiAgICB9CiAgICAxMDAlIHsKICAgICAgICBsZWZ0OiAwcHg7CiAgICAgICAgb3BhY2l0eTogMQogICAgfQp9CgpALXdlYmtpdC1rZXlmcmFtZXMgbW92ZUxlZnQgewogICAgMCUgewogICAgICAgIGxlZnQ6IDIwcHg7CiAgICAgICAgb3BhY2l0eTogMAogICAgfQogICAgMTAwJSB7CiAgICAgICAgbGVmdDogMHB4OwogICAgICAgIG9wYWNpdHk6IDEKICAgIH0KfQoKQG1lZGlhIChtYXgtd2lkdGg6IDM2N3B4KSB7CiAgICAuZnpESW5mbyB7CiAgICAgICAgd2lkdGg6IDgyJTsKICAgIH0KfQoK"},{"version":3,"sources":["chatBox.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4SA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"chatBox.vue","sourceRoot":"src/views/user/components","sourcesContent":["<template>\r\n    <el-card class=\"box-card\">\r\n        <el-container>\r\n            <el-main style=\"padding: 0\">\r\n                <div class=\"wxchat-container\" :style=\"{backgroundColor: wrapBg}\">\r\n                    <div class=\"window\" id=\"window-view-container\" style=\"height: 450px; position: relative\">\r\n                        <!-- data is empty -->\r\n                        <div class=\"loading\" v-if=\"msgList && msgList.length===0\">\r\n                            <div style=\"text-align:center; font-size: 16px;\">\r\n                                <span>未查找到聊天记录</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <!-- loading -->\r\n                        <div class=\"loading\" v-if=\"loading\">\r\n                            <div>\r\n                                <div>加载中...</div>\r\n                            </div>\r\n                        </div>\r\n                        <!-- main -->\r\n                        <ScrollLoader :minHeight=\"minHeight\" @scroll-to-top=\"refresh\" @scroll-to-botton=\"infinite\"\r\n                                      class=\"container-main\" v-if=\"msgList && msgList.length>0\"\r\n                                      style=\"height: 100%\">\r\n                            <div class=\"message\">\r\n                                <ul>\r\n                                    <li v-for=\"(message, index) in msgList\" :key=\"index\"\r\n                                        :class=\"message.my?'an-move-right':'an-move-left'\">\r\n                                        <p class=\"time\"><span v-text=\"message.ctime\"/></p>\r\n                                        <p class=\"time system\" v-if=\"message.type===10000\">\r\n                                            <span v-html=\"message.msg\"/>\r\n                                        </p>\r\n                                        <div :class=\"'main' + (message.my?' self':'')\" v-else>\r\n\r\n                                            <el-avatar v-if=\"!message.my\" class=\"avatar\" icon=\"el-icon-user-solid\"\r\n                                                       :size=\"50\"\r\n                                                       :src=\"avatar\">\r\n                                            </el-avatar>\r\n                                            <!-- 文本 -->\r\n                                            <div class=\"text\" v-html=\"message.msg\" v-if=\"message.type===1\"></div>\r\n\r\n                                            <!-- 图片 -->\r\n                                            <div class=\"text\" v-else-if=\"message.type===2\">\r\n                                                <el-image :src=\"message.msg\">\r\n                                                    <div slot=\"error\" class=\"image-slot\">\r\n                                                        <i class=\"el-icon-picture-outline\"></i>\r\n                                                        加载失败\r\n                                                    </div>\r\n                                                </el-image>\r\n                                            </div>\r\n\r\n                                            <!-- 其他 -->\r\n                                            <div class=\"text\" v-else-if=\"message.type!==10000\"\r\n                                                 v-text=\"'[暂未支持的消息类型:'+ message.type +']\\n\\r' + message.msg\">\r\n                                            </div>\r\n                                        </div>\r\n                                    </li>\r\n\r\n                                </ul>\r\n                            </div>\r\n                        </ScrollLoader>\r\n                        <div style=\"display:flex; position: absolute;bottom: 0;width: 100%;background-color: #FFF; padding: 5px;\">\r\n                            <el-input v-model=\"msg\" style=\"width: 70%\" placeholder=\"请输入发送内容\"/>\r\n                            <div style=\"width: 25%; display: flex; justify-content: center\">\r\n                                <el-button size=\"mini\" type=\"primary\" @click=\"sendMsg\">发送</el-button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n            </el-main>\r\n        </el-container>\r\n    </el-card>\r\n</template>\r\n\r\n<script>\r\n    import ScrollLoader from './scrollLoader.vue';\r\n\r\n    export default {\r\n        name: \"chatBox\",\r\n        components: {\r\n            ScrollLoader\r\n        },\r\n        props: {\r\n            userId: {\r\n                type: String,\r\n                default: '',\r\n                required: true,\r\n            },\r\n            nickname: {\r\n                type: String,\r\n                default: '',\r\n                required: true,\r\n            },\r\n            avatar: {\r\n                type: String,\r\n                default: 'https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg'\r\n            },\r\n\r\n            width: {\r\n                type: Number,\r\n                default: 650,\r\n            },\r\n\r\n            wrapBg: {\r\n                type: String,\r\n                default: '#efefef'\r\n            },\r\n\r\n            maxHeight: {\r\n                type: Number,\r\n                default: 700\r\n            },\r\n            minHeight: {\r\n                type: Number,\r\n                default: 700\r\n            },\r\n\r\n\r\n            ownerAvatarUrl: {\r\n                type: String,\r\n            }\r\n        },\r\n\r\n        data() {\r\n            return {\r\n                msg: '',\r\n                isUpperLaoding: false,\r\n                isUnderLaoding: false,\r\n                loading: false,\r\n\r\n                isRefreshedAll: false,\r\n                isLoadedAll: false,\r\n\r\n                msgList: [],\r\n\r\n                page: 1,\r\n                pageSize: 20,\r\n\r\n                socket: null\r\n            }\r\n        },\r\n        created() {\r\n            this.getData();\r\n            this.$ws.connect();\r\n            this.$ws.onMsg = (res) => {\r\n                console.log(\"聊天窗口\", res);\r\n                if (res.code === 200) {\r\n                    if (res.data) {\r\n                        let msgData = JSON.parse(res.data);\r\n                        this.msgList.push({\r\n                            msg: msgData.msg,\r\n                            my: false,\r\n                            type: 1\r\n                        });\r\n                    }\r\n                }\r\n\r\n            }\r\n        },\r\n\r\n        methods: {\r\n            async getData() {\r\n                let pageData = {\r\n                    pageSize: this.pageSize,\r\n                    page: this.page\r\n                };\r\n                this.$api.get(\"notice/member/\" + this.userId, pageData).then(res => {\r\n                    if (res.code === 200) {\r\n                        let _list = [];\r\n                        res.data.list.forEach(item => {\r\n                            _list.push({\r\n                                my: !item.userId,\r\n                                id: item.id, //根据这个来排序消息\r\n                                type: 1, //1为文本，2为图片\r\n                                msg: item.msg, //当type为1时这里是文本消息，当type2为2时这里要存放图片地址；后续会支持语音的显示\r\n                                ctime: item.createTime //显示当前消息的发送时间\r\n                            })\r\n                        });\r\n\r\n                        this.msgList = _list;\r\n                    }\r\n                })\r\n                // this.msgList = [{\r\n                //     my: false,\r\n                //     id: 1, //根据这个来排序消息\r\n                //     type: 1, //1为文本，2为图片\r\n                //     msg: '你好!![呲牙]', //当type为1时这里是文本消息，当type2为2时这里要存放图片地址；后续会支持语音的显示\r\n                //     ctime: new Date().toLocaleString() //显示当前消息的发送时间\r\n                // },\r\n                //     {\r\n                //         my: true,\r\n                //         id: 2,\r\n                //         type: 1,\r\n                //         msg: '你也好。[害羞]',\r\n                //         ctime: new Date().toLocaleString()\r\n                //     }];\r\n            },\r\n            sendMsg() {\r\n                // 消息为空不做任何操作\r\n                if (this.msg === \"\") {\r\n                    return this.$message.warning(\"消息不能为空\");\r\n                }\r\n                // 显示消息 msg消息文本,my鉴别是谁发的消息(不能用俩个消息数组循环,否则消息不会穿插)\r\n                var msg = this.msg.replace(/(^\\s*)|(\\s*$)/g, \"\");\r\n                if (!msg) return;\r\n                this.msgList.push({\r\n                    msg: msg,\r\n                    my: true,\r\n                    type: 1\r\n                });\r\n                // 保证消息可见\r\n                // this.msgGo()\r\n                // 回答问题\r\n                this.msgSendAction(this.msg);\r\n                // 清除消息\r\n                this.msg = \"\"\r\n            },\r\n            msgSendAction: function (x) {\r\n                // 这里连接服务器获取答案\r\n                // 下面模拟请求\r\n                this.$api.post(\"im\", {\r\n                    toUser: this.userId,\r\n                    msg: x\r\n                }).then(res => {\r\n                    if (res.code === 200) {\r\n                        // 消息发送成功 加载loading\r\n                        this.msgLoad = true;\r\n                    }\r\n                })\r\n            },\r\n\r\n            getUnderData() {\r\n\r\n            },\r\n\r\n            getUpperData() {\r\n\r\n            },\r\n\r\n            //向上拉刷新\r\n            refresh(done) {\r\n                var me = this;\r\n                if (me.isUpperLaoding) {\r\n                    return;\r\n                }\r\n\r\n                if (me.isRefreshedAll) {\r\n                    done(true);\r\n                    me.isUpperLaoding = false;\r\n                    return;\r\n                }\r\n\r\n                try {\r\n                    this.getUpperData().then(function (data) {\r\n                        if (data.length === 0) {\r\n                            me.isRefreshedAll = true;\r\n                            done(true);\r\n                        } else {\r\n                            me.msgList = data.reverse().concat(me.msgList); //倒序合并\r\n                            done();\r\n                        }\r\n                    })\r\n                } catch (error) {\r\n                    console.error('wxChat: props \"getUpperData\" must return a promise object!')\r\n                }\r\n                me.isUpperLaoding = false;\r\n            },\r\n\r\n            //向下拉加载\r\n            infinite(done) {\r\n                var me = this;\r\n                if (me.isUnderLaoding) {\r\n                    return;\r\n                }\r\n                if (me.isLoadedAll) {\r\n                    done(true);\r\n                    me.isUnderLaoding = false;\r\n                    return;\r\n                }\r\n\r\n                try {\r\n                    this.getUnderData().then(function (data) {\r\n                        if (data === 0) {\r\n                            me.isLoadedAll = true;\r\n                            done(true);\r\n                        } else {\r\n                            done();\r\n                            me.msgList = me.msgList.concat(data); //直接合并\r\n                        }\r\n                    })\r\n                } catch (error) {\r\n                    console.error('wxChat: props \"getUnderData\" must return a promise object!')\r\n                }\r\n                me.isUnderLaoding = false;\r\n            }\r\n\r\n        }\r\n    }\r\n</script>\r\n<style scoped>\r\n    >>> .el-card__body {\r\n        padding: 0;\r\n    }\r\n\r\n    .shadow {\r\n        position: absolute;\r\n        top: 0;\r\n        left: 0;\r\n        z-index: 100;\r\n        width: 100%;\r\n        height: 100%;\r\n        background: #000;\r\n        opacity: .2;\r\n    }\r\n\r\n    .window {\r\n        min-width: 300px;\r\n        background: #F5F5F5;\r\n        overflow: hidden;\r\n        padding: 0;\r\n        height: 100%;\r\n        position: relative;\r\n        z-index: 101;\r\n    }\r\n\r\n    .w100 {\r\n        width: 100%;\r\n    }\r\n\r\n    .mt5 {\r\n        margin-top: 5px;\r\n    }\r\n\r\n    .mt10 {\r\n        margin-top: 10px;\r\n    }\r\n\r\n    .mt20 {\r\n        margin-top: 20px;\r\n    }\r\n\r\n    .mb10 {\r\n        margin-bottom: 10px;\r\n    }\r\n\r\n    .mb20 {\r\n        margin-bottom: 20px;\r\n    }\r\n\r\n    .fs0 {\r\n        font-size: 0\r\n    }\r\n\r\n    .title {\r\n        background: #000;\r\n        text-align: center;\r\n        color: #fff;\r\n        width: 100%;\r\n        height: 50px;\r\n        line-height: 50px;\r\n        font-size: 14px;\r\n    }\r\n\r\n    .loading, .no-more {\r\n        text-align: center;\r\n        color: #b0b0b0;\r\n        line-height: 100px;\r\n    }\r\n\r\n    .no-more {\r\n        line-height: 60px;\r\n    }\r\n\r\n    .pull-right {\r\n        float: right;\r\n    }\r\n\r\n    .link-line {\r\n        text-decoration: underline;\r\n    }\r\n\r\n    .message {\r\n        /*height: 100%;*/\r\n        padding: 10px 15px;\r\n        /*overflow-y: scroll;*/\r\n        background-color: #F5F5F5;\r\n    }\r\n\r\n    .message li {\r\n        margin-bottom: 15px;\r\n        left: 0;\r\n        position: relative;\r\n        display: block;\r\n    }\r\n\r\n    .message .time {\r\n        margin: 10px 0;\r\n        text-align: center;\r\n    }\r\n\r\n    .message .text {\r\n        display: inline-block;\r\n        position: relative;\r\n        max-width: calc(100% - 75px);\r\n        min-height: 35px;\r\n        line-height: 2.1;\r\n        font-size: 15px;\r\n        padding: 6px 10px;\r\n        text-align: left;\r\n        word-break: break-all;\r\n        background-color: #fff;\r\n        color: #000;\r\n        border-radius: 4px;\r\n        box-shadow: 0px 1px 7px -5px #000;\r\n    }\r\n\r\n    .message .avatar {\r\n        float: left;\r\n        margin: 0 10px 0 0;\r\n    }\r\n\r\n    .message .time > span {\r\n        display: inline-block;\r\n        padding: 0 5px;\r\n        font-size: 12px;\r\n        color: #fff;\r\n        border-radius: 2px;\r\n        background-color: #DADADA;\r\n    }\r\n\r\n    .message .system > span {\r\n        padding: 4px 9px;\r\n        text-align: left;\r\n    }\r\n\r\n    .message .text:before {\r\n        content: \" \";\r\n        position: absolute;\r\n        top: 9px;\r\n        right: 100%;\r\n        border: 6px solid transparent;\r\n        border-right-color: #fff;\r\n    }\r\n\r\n    .message .self {\r\n        text-align: right;\r\n    }\r\n\r\n    .message .self .avatar {\r\n        float: right;\r\n        margin: 0 0 0 10px;\r\n    }\r\n\r\n    .message .self .text {\r\n        background-color: #9EEA6A;\r\n    }\r\n\r\n    .message .self .text:before {\r\n        right: inherit;\r\n        left: 100%;\r\n        border-right-color: transparent;\r\n        border-left-color: #9EEA6A;\r\n    }\r\n\r\n    .message .image {\r\n        max-width: 200px;\r\n    }\r\n\r\n    img.static-emotion-gif, img.static-emotion {\r\n        vertical-align: middle !important;\r\n    }\r\n\r\n    .an-move-left {\r\n        left: 0;\r\n        animation: moveLeft .7s ease;\r\n        -webkit-animation: moveLeft .7s ease;\r\n    }\r\n\r\n    .an-move-right {\r\n        left: 0;\r\n        animation: moveRight .7s ease;\r\n        -webkit-animation: moveRight .7s ease;\r\n    }\r\n\r\n    .bgnone {\r\n        background: none;\r\n    }\r\n\r\n    @keyframes moveRight {\r\n        0% {\r\n            left: -30px;\r\n            opacity: 0\r\n        }\r\n        100% {\r\n            left: 0;\r\n            opacity: 1\r\n        }\r\n    }\r\n\r\n    @-webkit-keyframes moveRight {\r\n        0% {\r\n            left: -50px;\r\n            opacity: 0\r\n        }\r\n        100% {\r\n            left: 0px;\r\n            opacity: 1\r\n        }\r\n    }\r\n\r\n    @keyframes moveLeft {\r\n        0% {\r\n            left: 20px;\r\n            opacity: 0\r\n        }\r\n        100% {\r\n            left: 0px;\r\n            opacity: 1\r\n        }\r\n    }\r\n\r\n    @-webkit-keyframes moveLeft {\r\n        0% {\r\n            left: 20px;\r\n            opacity: 0\r\n        }\r\n        100% {\r\n            left: 0px;\r\n            opacity: 1\r\n        }\r\n    }\r\n\r\n    @media (max-width: 367px) {\r\n        .fzDInfo {\r\n            width: 82%;\r\n        }\r\n    }\r\n\r\n</style>\r\n"]}]}