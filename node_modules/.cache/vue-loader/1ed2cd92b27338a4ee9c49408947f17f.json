{"remainingRequest":"G:\\RQDL\\base\\backend-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\RQDL\\base\\backend-admin\\src\\views\\user\\components\\chatBox.vue?vue&type=script&lang=js&","dependencies":[{"path":"G:\\RQDL\\base\\backend-admin\\src\\views\\user\\components\\chatBox.vue","mtime":1620715077891},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBTY3JvbGxMb2FkZXIgZnJvbSAnLi9zY3JvbGxMb2FkZXIudnVlJzsKCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICJjaGF0Qm94IiwKICAgIGNvbXBvbmVudHM6IHsKICAgICAgICBTY3JvbGxMb2FkZXIKICAgIH0sCiAgICBwcm9wczogewogICAgICAgIHVzZXJJZDogewogICAgICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgICAgIGRlZmF1bHQ6ICcnLAogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICB9LAogICAgICAgIG5pY2tuYW1lOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogJycsCiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgIH0sCiAgICAgICAgYXZhdGFyOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogJ2h0dHBzOi8vZnVzczEwLmVsZW1lY2RuLmNvbS9lLzVkLzRhNzMxYTkwNTk0YTRhZjU0NGMwYzI1OTQxMTcxanBlZy5qcGVnJwogICAgICAgIH0sCgogICAgICAgIHdpZHRoOiB7CiAgICAgICAgICAgIHR5cGU6IE51bWJlciwKICAgICAgICAgICAgZGVmYXVsdDogNjUwLAogICAgICAgIH0sCgogICAgICAgIHdyYXBCZzogewogICAgICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgICAgIGRlZmF1bHQ6ICcjZWZlZmVmJwogICAgICAgIH0sCgogICAgICAgIG1heEhlaWdodDogewogICAgICAgICAgICB0eXBlOiBOdW1iZXIsCiAgICAgICAgICAgIGRlZmF1bHQ6IDcwMAogICAgICAgIH0sCiAgICAgICAgbWluSGVpZ2h0OiB7CiAgICAgICAgICAgIHR5cGU6IE51bWJlciwKICAgICAgICAgICAgZGVmYXVsdDogNzAwCiAgICAgICAgfSwKCgogICAgICAgIG93bmVyQXZhdGFyVXJsOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICB9CiAgICB9LAoKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgbXNnOiAnJywKICAgICAgICAgICAgaXNVcHBlckxhb2Rpbmc6IGZhbHNlLAogICAgICAgICAgICBpc1VuZGVyTGFvZGluZzogZmFsc2UsCiAgICAgICAgICAgIGxvYWRpbmc6IGZhbHNlLAoKICAgICAgICAgICAgaXNSZWZyZXNoZWRBbGw6IGZhbHNlLAogICAgICAgICAgICBpc0xvYWRlZEFsbDogZmFsc2UsCgogICAgICAgICAgICBtc2dMaXN0OiBbXSwKCiAgICAgICAgICAgIHBhZ2U6IDEsCiAgICAgICAgICAgIHBhZ2VTaXplOiAyMCwKCiAgICAgICAgICAgIHNvY2tldDogbnVsbAogICAgICAgIH0KICAgIH0sCiAgICBjcmVhdGVkKCkgewogICAgICAgIHRoaXMuZ2V0RGF0YSgpOwogICAgICAgIHRoaXMuJHdzLmNvbm5lY3QoKTsKICAgICAgICB0aGlzLiR3cy5vbk1zZyA9IChyZXMpID0+IHsKICAgICAgICAgICAgY29uc29sZS5sb2coIuiBiuWkqeeql+WPoyIsIHJlcyk7CiAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgbXNnRGF0YSA9IEpTT04ucGFyc2UocmVzLmRhdGEpOwogICAgICAgICAgICAgICAgICAgIHRoaXMubXNnTGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgbXNnOiBtc2dEYXRhLm1zZywKICAgICAgICAgICAgICAgICAgICAgICAgbXk6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAxCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgfQogICAgfSwKCiAgICBtZXRob2RzOiB7CiAgICAgICAgYXN5bmMgZ2V0RGF0YSgpIHsKICAgICAgICAgICAgbGV0IHBhZ2VEYXRhID0gewogICAgICAgICAgICAgICAgcGFnZVNpemU6IHRoaXMucGFnZVNpemUsCiAgICAgICAgICAgICAgICBwYWdlOiB0aGlzLnBhZ2UKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdGhpcy4kYXBpLmdldCgibm90aWNlL21lbWJlci8iICsgdGhpcy51c2VySWQsIHBhZ2VEYXRhKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICBpZiAocmVzLmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgIGxldCBfbGlzdCA9IFtdOwogICAgICAgICAgICAgICAgICAgIHJlcy5kYXRhLmxpc3QuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgX2xpc3QucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBteTogIWl0ZW0udXNlcklkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGl0ZW0uaWQsIC8v5qC55o2u6L+Z5Liq5p2l5o6S5bqP5raI5oGvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAxLCAvLzHkuLrmlofmnKzvvIwy5Li65Zu+54mHCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2c6IGl0ZW0ubXNnLCAvL+W9k3R5cGXkuLox5pe26L+Z6YeM5piv5paH5pys5raI5oGv77yM5b2TdHlwZTLkuLoy5pe26L+Z6YeM6KaB5a2Y5pS+5Zu+54mH5Zyw5Z2A77yb5ZCO57ut5Lya5pSv5oyB6K+t6Z+z55qE5pi+56S6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdGltZTogaXRlbS5jcmVhdGVUaW1lIC8v5pi+56S65b2T5YmN5raI5oGv55qE5Y+R6YCB5pe26Ze0CiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgIHRoaXMubXNnTGlzdCA9IF9saXN0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgICAvLyB0aGlzLm1zZ0xpc3QgPSBbewogICAgICAgICAgICAvLyAgICAgbXk6IGZhbHNlLAogICAgICAgICAgICAvLyAgICAgaWQ6IDEsIC8v5qC55o2u6L+Z5Liq5p2l5o6S5bqP5raI5oGvCiAgICAgICAgICAgIC8vICAgICB0eXBlOiAxLCAvLzHkuLrmlofmnKzvvIwy5Li65Zu+54mHCiAgICAgICAgICAgIC8vICAgICBtc2c6ICfkvaDlpb0hIVvlkbLniZldJywgLy/lvZN0eXBl5Li6MeaXtui/memHjOaYr+aWh+acrOa2iOaBr++8jOW9k3R5cGUy5Li6MuaXtui/memHjOimgeWtmOaUvuWbvueJh+WcsOWdgO+8m+WQjue7reS8muaUr+aMgeivremfs+eahOaYvuekugogICAgICAgICAgICAvLyAgICAgY3RpbWU6IG5ldyBEYXRlKCkudG9Mb2NhbGVTdHJpbmcoKSAvL+aYvuekuuW9k+WJjea2iOaBr+eahOWPkemAgeaXtumXtAogICAgICAgICAgICAvLyB9LAogICAgICAgICAgICAvLyAgICAgewogICAgICAgICAgICAvLyAgICAgICAgIG15OiB0cnVlLAogICAgICAgICAgICAvLyAgICAgICAgIGlkOiAyLAogICAgICAgICAgICAvLyAgICAgICAgIHR5cGU6IDEsCiAgICAgICAgICAgIC8vICAgICAgICAgbXNnOiAn5L2g5Lmf5aW944CCW+Wus+e+nl0nLAogICAgICAgICAgICAvLyAgICAgICAgIGN0aW1lOiBuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCkKICAgICAgICAgICAgLy8gICAgIH1dOwogICAgICAgIH0sCiAgICAgICAgc2VuZE1zZygpIHsKICAgICAgICAgICAgLy8g5raI5oGv5Li656m65LiN5YGa5Lu75L2V5pON5L2cCiAgICAgICAgICAgIGlmICh0aGlzLm1zZyA9PT0gIiIpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLndhcm5pbmcoIua2iOaBr+S4jeiDveS4uuepuiIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIOaYvuekuua2iOaBryBtc2fmtojmga/mlofmnKwsbXnpibTliKvmmK/osIHlj5HnmoTmtojmga8o5LiN6IO955So5L+p5Liq5raI5oGv5pWw57uE5b6q546vLOWQpuWImea2iOaBr+S4jeS8muepv+aPkikKICAgICAgICAgICAgdmFyIG1zZyA9IHRoaXMubXNnLnJlcGxhY2UoLyheXHMqKXwoXHMqJCkvZywgIiIpOwogICAgICAgICAgICBpZiAoIW1zZykgcmV0dXJuOwogICAgICAgICAgICB0aGlzLm1zZ0xpc3QucHVzaCh7CiAgICAgICAgICAgICAgICBtc2c6IG1zZywKICAgICAgICAgICAgICAgIG15OiB0cnVlLAogICAgICAgICAgICAgICAgdHlwZTogMQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgLy8g5L+d6K+B5raI5oGv5Y+v6KeBCiAgICAgICAgICAgIC8vIHRoaXMubXNnR28oKQogICAgICAgICAgICAvLyDlm57nrZTpl67popgKICAgICAgICAgICAgdGhpcy5tc2dTZW5kQWN0aW9uKHRoaXMubXNnKTsKICAgICAgICAgICAgLy8g5riF6Zmk5raI5oGvCiAgICAgICAgICAgIHRoaXMubXNnID0gIiIKICAgICAgICB9LAogICAgICAgIG1zZ1NlbmRBY3Rpb246IGZ1bmN0aW9uICh4KSB7CiAgICAgICAgICAgIC8vIOi/memHjOi/nuaOpeacjeWKoeWZqOiOt+WPluetlOahiAogICAgICAgICAgICAvLyDkuIvpnaLmqKHmi5/or7fmsYIKICAgICAgICAgICAgdGhpcy4kYXBpLnBvc3QoImltIiwgewogICAgICAgICAgICAgICAgdG9Vc2VyOiB0aGlzLnVzZXJJZCwKICAgICAgICAgICAgICAgIG1zZzogeAogICAgICAgICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICBpZiAocmVzLmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgIC8vIOa2iOaBr+WPkemAgeaIkOWKnyDliqDovb1sb2FkaW5nCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tc2dMb2FkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICB9LAoKICAgICAgICBnZXRVbmRlckRhdGEoKSB7CgogICAgICAgIH0sCgogICAgICAgIGdldFVwcGVyRGF0YSgpIHsKCiAgICAgICAgfSwKCiAgICAgICAgLy/lkJHkuIrmi4nliLfmlrAKICAgICAgICByZWZyZXNoKGRvbmUpIHsKICAgICAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICAgICAgaWYgKG1lLmlzVXBwZXJMYW9kaW5nKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChtZS5pc1JlZnJlc2hlZEFsbCkgewogICAgICAgICAgICAgICAgZG9uZSh0cnVlKTsKICAgICAgICAgICAgICAgIG1lLmlzVXBwZXJMYW9kaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICB0aGlzLmdldFVwcGVyRGF0YSgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgbWUuaXNSZWZyZXNoZWRBbGwgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBkb25lKHRydWUpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG1lLm1zZ0xpc3QgPSBkYXRhLnJldmVyc2UoKS5jb25jYXQobWUubXNnTGlzdCk7IC8v5YCS5bqP5ZCI5bm2CiAgICAgICAgICAgICAgICAgICAgICAgIGRvbmUoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignd3hDaGF0OiBwcm9wcyAiZ2V0VXBwZXJEYXRhIiBtdXN0IHJldHVybiBhIHByb21pc2Ugb2JqZWN0IScpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgbWUuaXNVcHBlckxhb2RpbmcgPSBmYWxzZTsKICAgICAgICB9LAoKICAgICAgICAvL+WQkeS4i+aLieWKoOi9vQogICAgICAgIGluZmluaXRlKGRvbmUpIHsKICAgICAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICAgICAgaWYgKG1lLmlzVW5kZXJMYW9kaW5nKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKG1lLmlzTG9hZGVkQWxsKSB7CiAgICAgICAgICAgICAgICBkb25lKHRydWUpOwogICAgICAgICAgICAgICAgbWUuaXNVbmRlckxhb2RpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHRoaXMuZ2V0VW5kZXJEYXRhKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIGlmIChkYXRhID09PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG1lLmlzTG9hZGVkQWxsID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgZG9uZSh0cnVlKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBkb25lKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIG1lLm1zZ0xpc3QgPSBtZS5tc2dMaXN0LmNvbmNhdChkYXRhKTsgLy/nm7TmjqXlkIjlubYKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignd3hDaGF0OiBwcm9wcyAiZ2V0VW5kZXJEYXRhIiBtdXN0IHJldHVybiBhIHByb21pc2Ugb2JqZWN0IScpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgbWUuaXNVbmRlckxhb2RpbmcgPSBmYWxzZTsKICAgICAgICB9CgogICAgfQp9Cg=="},{"version":3,"sources":["chatBox.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2EA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"chatBox.vue","sourceRoot":"src/views/user/components","sourcesContent":["<template>\r\n    <el-card class=\"box-card\">\r\n        <el-container>\r\n            <el-main style=\"padding: 0\">\r\n                <div class=\"wxchat-container\" :style=\"{backgroundColor: wrapBg}\">\r\n                    <div class=\"window\" id=\"window-view-container\" style=\"height: 450px; position: relative\">\r\n                        <!-- data is empty -->\r\n                        <div class=\"loading\" v-if=\"msgList && msgList.length===0\">\r\n                            <div style=\"text-align:center; font-size: 16px;\">\r\n                                <span>未查找到聊天记录</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <!-- loading -->\r\n                        <div class=\"loading\" v-if=\"loading\">\r\n                            <div>\r\n                                <div>加载中...</div>\r\n                            </div>\r\n                        </div>\r\n                        <!-- main -->\r\n                        <ScrollLoader :minHeight=\"minHeight\" @scroll-to-top=\"refresh\" @scroll-to-botton=\"infinite\"\r\n                                      class=\"container-main\" v-if=\"msgList && msgList.length>0\"\r\n                                      style=\"height: 100%\">\r\n                            <div class=\"message\">\r\n                                <ul>\r\n                                    <li v-for=\"(message, index) in msgList\" :key=\"index\"\r\n                                        :class=\"message.my?'an-move-right':'an-move-left'\">\r\n                                        <p class=\"time\"><span v-text=\"message.ctime\"/></p>\r\n                                        <p class=\"time system\" v-if=\"message.type===10000\">\r\n                                            <span v-html=\"message.msg\"/>\r\n                                        </p>\r\n                                        <div :class=\"'main' + (message.my?' self':'')\" v-else>\r\n\r\n                                            <el-avatar v-if=\"!message.my\" class=\"avatar\" icon=\"el-icon-user-solid\"\r\n                                                       :size=\"50\"\r\n                                                       :src=\"avatar\">\r\n                                            </el-avatar>\r\n                                            <!-- 文本 -->\r\n                                            <div class=\"text\" v-html=\"message.msg\" v-if=\"message.type===1\"></div>\r\n\r\n                                            <!-- 图片 -->\r\n                                            <div class=\"text\" v-else-if=\"message.type===2\">\r\n                                                <el-image :src=\"message.msg\">\r\n                                                    <div slot=\"error\" class=\"image-slot\">\r\n                                                        <i class=\"el-icon-picture-outline\"></i>\r\n                                                        加载失败\r\n                                                    </div>\r\n                                                </el-image>\r\n                                            </div>\r\n\r\n                                            <!-- 其他 -->\r\n                                            <div class=\"text\" v-else-if=\"message.type!==10000\"\r\n                                                 v-text=\"'[暂未支持的消息类型:'+ message.type +']\\n\\r' + message.msg\">\r\n                                            </div>\r\n                                        </div>\r\n                                    </li>\r\n\r\n                                </ul>\r\n                            </div>\r\n                        </ScrollLoader>\r\n                        <div style=\"display:flex; position: absolute;bottom: 0;width: 100%;background-color: #FFF; padding: 5px;\">\r\n                            <el-input v-model=\"msg\" style=\"width: 70%\" placeholder=\"请输入发送内容\"/>\r\n                            <div style=\"width: 25%; display: flex; justify-content: center\">\r\n                                <el-button size=\"mini\" type=\"primary\" @click=\"sendMsg\">发送</el-button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n            </el-main>\r\n        </el-container>\r\n    </el-card>\r\n</template>\r\n\r\n<script>\r\n    import ScrollLoader from './scrollLoader.vue';\r\n\r\n    export default {\r\n        name: \"chatBox\",\r\n        components: {\r\n            ScrollLoader\r\n        },\r\n        props: {\r\n            userId: {\r\n                type: String,\r\n                default: '',\r\n                required: true,\r\n            },\r\n            nickname: {\r\n                type: String,\r\n                default: '',\r\n                required: true,\r\n            },\r\n            avatar: {\r\n                type: String,\r\n                default: 'https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg'\r\n            },\r\n\r\n            width: {\r\n                type: Number,\r\n                default: 650,\r\n            },\r\n\r\n            wrapBg: {\r\n                type: String,\r\n                default: '#efefef'\r\n            },\r\n\r\n            maxHeight: {\r\n                type: Number,\r\n                default: 700\r\n            },\r\n            minHeight: {\r\n                type: Number,\r\n                default: 700\r\n            },\r\n\r\n\r\n            ownerAvatarUrl: {\r\n                type: String,\r\n            }\r\n        },\r\n\r\n        data() {\r\n            return {\r\n                msg: '',\r\n                isUpperLaoding: false,\r\n                isUnderLaoding: false,\r\n                loading: false,\r\n\r\n                isRefreshedAll: false,\r\n                isLoadedAll: false,\r\n\r\n                msgList: [],\r\n\r\n                page: 1,\r\n                pageSize: 20,\r\n\r\n                socket: null\r\n            }\r\n        },\r\n        created() {\r\n            this.getData();\r\n            this.$ws.connect();\r\n            this.$ws.onMsg = (res) => {\r\n                console.log(\"聊天窗口\", res);\r\n                if (res.code === 200) {\r\n                    if (res.data) {\r\n                        let msgData = JSON.parse(res.data);\r\n                        this.msgList.push({\r\n                            msg: msgData.msg,\r\n                            my: false,\r\n                            type: 1\r\n                        });\r\n                    }\r\n                }\r\n\r\n            }\r\n        },\r\n\r\n        methods: {\r\n            async getData() {\r\n                let pageData = {\r\n                    pageSize: this.pageSize,\r\n                    page: this.page\r\n                };\r\n                this.$api.get(\"notice/member/\" + this.userId, pageData).then(res => {\r\n                    if (res.code === 200) {\r\n                        let _list = [];\r\n                        res.data.list.forEach(item => {\r\n                            _list.push({\r\n                                my: !item.userId,\r\n                                id: item.id, //根据这个来排序消息\r\n                                type: 1, //1为文本，2为图片\r\n                                msg: item.msg, //当type为1时这里是文本消息，当type2为2时这里要存放图片地址；后续会支持语音的显示\r\n                                ctime: item.createTime //显示当前消息的发送时间\r\n                            })\r\n                        });\r\n\r\n                        this.msgList = _list;\r\n                    }\r\n                })\r\n                // this.msgList = [{\r\n                //     my: false,\r\n                //     id: 1, //根据这个来排序消息\r\n                //     type: 1, //1为文本，2为图片\r\n                //     msg: '你好!![呲牙]', //当type为1时这里是文本消息，当type2为2时这里要存放图片地址；后续会支持语音的显示\r\n                //     ctime: new Date().toLocaleString() //显示当前消息的发送时间\r\n                // },\r\n                //     {\r\n                //         my: true,\r\n                //         id: 2,\r\n                //         type: 1,\r\n                //         msg: '你也好。[害羞]',\r\n                //         ctime: new Date().toLocaleString()\r\n                //     }];\r\n            },\r\n            sendMsg() {\r\n                // 消息为空不做任何操作\r\n                if (this.msg === \"\") {\r\n                    return this.$message.warning(\"消息不能为空\");\r\n                }\r\n                // 显示消息 msg消息文本,my鉴别是谁发的消息(不能用俩个消息数组循环,否则消息不会穿插)\r\n                var msg = this.msg.replace(/(^\\s*)|(\\s*$)/g, \"\");\r\n                if (!msg) return;\r\n                this.msgList.push({\r\n                    msg: msg,\r\n                    my: true,\r\n                    type: 1\r\n                });\r\n                // 保证消息可见\r\n                // this.msgGo()\r\n                // 回答问题\r\n                this.msgSendAction(this.msg);\r\n                // 清除消息\r\n                this.msg = \"\"\r\n            },\r\n            msgSendAction: function (x) {\r\n                // 这里连接服务器获取答案\r\n                // 下面模拟请求\r\n                this.$api.post(\"im\", {\r\n                    toUser: this.userId,\r\n                    msg: x\r\n                }).then(res => {\r\n                    if (res.code === 200) {\r\n                        // 消息发送成功 加载loading\r\n                        this.msgLoad = true;\r\n                    }\r\n                })\r\n            },\r\n\r\n            getUnderData() {\r\n\r\n            },\r\n\r\n            getUpperData() {\r\n\r\n            },\r\n\r\n            //向上拉刷新\r\n            refresh(done) {\r\n                var me = this;\r\n                if (me.isUpperLaoding) {\r\n                    return;\r\n                }\r\n\r\n                if (me.isRefreshedAll) {\r\n                    done(true);\r\n                    me.isUpperLaoding = false;\r\n                    return;\r\n                }\r\n\r\n                try {\r\n                    this.getUpperData().then(function (data) {\r\n                        if (data.length === 0) {\r\n                            me.isRefreshedAll = true;\r\n                            done(true);\r\n                        } else {\r\n                            me.msgList = data.reverse().concat(me.msgList); //倒序合并\r\n                            done();\r\n                        }\r\n                    })\r\n                } catch (error) {\r\n                    console.error('wxChat: props \"getUpperData\" must return a promise object!')\r\n                }\r\n                me.isUpperLaoding = false;\r\n            },\r\n\r\n            //向下拉加载\r\n            infinite(done) {\r\n                var me = this;\r\n                if (me.isUnderLaoding) {\r\n                    return;\r\n                }\r\n                if (me.isLoadedAll) {\r\n                    done(true);\r\n                    me.isUnderLaoding = false;\r\n                    return;\r\n                }\r\n\r\n                try {\r\n                    this.getUnderData().then(function (data) {\r\n                        if (data === 0) {\r\n                            me.isLoadedAll = true;\r\n                            done(true);\r\n                        } else {\r\n                            done();\r\n                            me.msgList = me.msgList.concat(data); //直接合并\r\n                        }\r\n                    })\r\n                } catch (error) {\r\n                    console.error('wxChat: props \"getUnderData\" must return a promise object!')\r\n                }\r\n                me.isUnderLaoding = false;\r\n            }\r\n\r\n        }\r\n    }\r\n</script>\r\n<style scoped>\r\n    >>> .el-card__body {\r\n        padding: 0;\r\n    }\r\n\r\n    .shadow {\r\n        position: absolute;\r\n        top: 0;\r\n        left: 0;\r\n        z-index: 100;\r\n        width: 100%;\r\n        height: 100%;\r\n        background: #000;\r\n        opacity: .2;\r\n    }\r\n\r\n    .window {\r\n        min-width: 300px;\r\n        background: #F5F5F5;\r\n        overflow: hidden;\r\n        padding: 0;\r\n        height: 100%;\r\n        position: relative;\r\n        z-index: 101;\r\n    }\r\n\r\n    .w100 {\r\n        width: 100%;\r\n    }\r\n\r\n    .mt5 {\r\n        margin-top: 5px;\r\n    }\r\n\r\n    .mt10 {\r\n        margin-top: 10px;\r\n    }\r\n\r\n    .mt20 {\r\n        margin-top: 20px;\r\n    }\r\n\r\n    .mb10 {\r\n        margin-bottom: 10px;\r\n    }\r\n\r\n    .mb20 {\r\n        margin-bottom: 20px;\r\n    }\r\n\r\n    .fs0 {\r\n        font-size: 0\r\n    }\r\n\r\n    .title {\r\n        background: #000;\r\n        text-align: center;\r\n        color: #fff;\r\n        width: 100%;\r\n        height: 50px;\r\n        line-height: 50px;\r\n        font-size: 14px;\r\n    }\r\n\r\n    .loading, .no-more {\r\n        text-align: center;\r\n        color: #b0b0b0;\r\n        line-height: 100px;\r\n    }\r\n\r\n    .no-more {\r\n        line-height: 60px;\r\n    }\r\n\r\n    .pull-right {\r\n        float: right;\r\n    }\r\n\r\n    .link-line {\r\n        text-decoration: underline;\r\n    }\r\n\r\n    .message {\r\n        /*height: 100%;*/\r\n        padding: 10px 15px;\r\n        /*overflow-y: scroll;*/\r\n        background-color: #F5F5F5;\r\n    }\r\n\r\n    .message li {\r\n        margin-bottom: 15px;\r\n        left: 0;\r\n        position: relative;\r\n        display: block;\r\n    }\r\n\r\n    .message .time {\r\n        margin: 10px 0;\r\n        text-align: center;\r\n    }\r\n\r\n    .message .text {\r\n        display: inline-block;\r\n        position: relative;\r\n        max-width: calc(100% - 75px);\r\n        min-height: 35px;\r\n        line-height: 2.1;\r\n        font-size: 15px;\r\n        padding: 6px 10px;\r\n        text-align: left;\r\n        word-break: break-all;\r\n        background-color: #fff;\r\n        color: #000;\r\n        border-radius: 4px;\r\n        box-shadow: 0px 1px 7px -5px #000;\r\n    }\r\n\r\n    .message .avatar {\r\n        float: left;\r\n        margin: 0 10px 0 0;\r\n    }\r\n\r\n    .message .time > span {\r\n        display: inline-block;\r\n        padding: 0 5px;\r\n        font-size: 12px;\r\n        color: #fff;\r\n        border-radius: 2px;\r\n        background-color: #DADADA;\r\n    }\r\n\r\n    .message .system > span {\r\n        padding: 4px 9px;\r\n        text-align: left;\r\n    }\r\n\r\n    .message .text:before {\r\n        content: \" \";\r\n        position: absolute;\r\n        top: 9px;\r\n        right: 100%;\r\n        border: 6px solid transparent;\r\n        border-right-color: #fff;\r\n    }\r\n\r\n    .message .self {\r\n        text-align: right;\r\n    }\r\n\r\n    .message .self .avatar {\r\n        float: right;\r\n        margin: 0 0 0 10px;\r\n    }\r\n\r\n    .message .self .text {\r\n        background-color: #9EEA6A;\r\n    }\r\n\r\n    .message .self .text:before {\r\n        right: inherit;\r\n        left: 100%;\r\n        border-right-color: transparent;\r\n        border-left-color: #9EEA6A;\r\n    }\r\n\r\n    .message .image {\r\n        max-width: 200px;\r\n    }\r\n\r\n    img.static-emotion-gif, img.static-emotion {\r\n        vertical-align: middle !important;\r\n    }\r\n\r\n    .an-move-left {\r\n        left: 0;\r\n        animation: moveLeft .7s ease;\r\n        -webkit-animation: moveLeft .7s ease;\r\n    }\r\n\r\n    .an-move-right {\r\n        left: 0;\r\n        animation: moveRight .7s ease;\r\n        -webkit-animation: moveRight .7s ease;\r\n    }\r\n\r\n    .bgnone {\r\n        background: none;\r\n    }\r\n\r\n    @keyframes moveRight {\r\n        0% {\r\n            left: -30px;\r\n            opacity: 0\r\n        }\r\n        100% {\r\n            left: 0;\r\n            opacity: 1\r\n        }\r\n    }\r\n\r\n    @-webkit-keyframes moveRight {\r\n        0% {\r\n            left: -50px;\r\n            opacity: 0\r\n        }\r\n        100% {\r\n            left: 0px;\r\n            opacity: 1\r\n        }\r\n    }\r\n\r\n    @keyframes moveLeft {\r\n        0% {\r\n            left: 20px;\r\n            opacity: 0\r\n        }\r\n        100% {\r\n            left: 0px;\r\n            opacity: 1\r\n        }\r\n    }\r\n\r\n    @-webkit-keyframes moveLeft {\r\n        0% {\r\n            left: 20px;\r\n            opacity: 0\r\n        }\r\n        100% {\r\n            left: 0px;\r\n            opacity: 1\r\n        }\r\n    }\r\n\r\n    @media (max-width: 367px) {\r\n        .fzDInfo {\r\n            width: 82%;\r\n        }\r\n    }\r\n\r\n</style>\r\n"]}]}