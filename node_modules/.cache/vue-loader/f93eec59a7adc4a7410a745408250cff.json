{"remainingRequest":"G:\\RQDL\\base\\backend-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\RQDL\\base\\backend-admin\\src\\views\\conf\\config.vue?vue&type=script&lang=js&","dependencies":[{"path":"G:\\RQDL\\base\\backend-admin\\src\\views\\conf\\config.vue","mtime":1621303824009},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\RQDL\\base\\backend-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBWdWUgZnJvbSAndnVlJzsKClZ1ZS5maWx0ZXIoInJvbGVSZWJhdGVUZXh0IiwgZnVuY3Rpb24gKHZhbCkgewogICAgbGV0IF9hcnIgPSBKU09OLnBhcnNlKHZhbCk7CiAgICBsZXQgX3N0ciA9IFtdOwogICAgaWYgKEFycmF5LmlzQXJyYXkoX2FycikpIHsKICAgICAgICBfYXJyLmZvckVhY2goKGl0ZW0pID0+IHsKICAgICAgICAgICAgX3N0ci5wdXNoKGl0ZW0ubHYgKyAi57qn5o+Q5oiQOiAiICsgaXRlbS5yZWJhdGUpCiAgICAgICAgfSkKICAgIH0KICAgIHJldHVybiBfc3RyLmpvaW4oIu+8myIpCn0pOwpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAiY29uZmlnIiwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgaXNVc2U6IHRydWUsCiAgICAgICAgICAgIGlzVXNlVGV4dDogJ+W3suWQr+eUqCcsCiAgICAgICAgICAgIGNvbmY6IHsKICAgICAgICAgICAgICAgIGZyb250VXJsOiAnJywKICAgICAgICAgICAgICAgIGluZGV4UGFnZVR5cGU6ICcnLAogICAgICAgICAgICAgICAgcmVhbE5hbWU6IGZhbHNlLAogICAgICAgICAgICAgICAgYXV0b1RYOiBmYWxzZSwKICAgICAgICAgICAgICAgIHNob3BBcHBseTogZmFsc2UsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHZpcDogdGhpcy4kc3RvcmUuc3RhdGUuc2hvcC52aXAKICAgICAgICB9CiAgICB9LAogICAgY3JlYXRlZCgpIHsKICAgICAgICB0aGlzLiRhcGkuZ2V0KCJjb21wYW55L2NvbmYiKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLmNvbmYgPSBKU09OLnBhcnNlKHJlcy5kYXRhLmNvbmZpZykgfHwge307CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgY2xlYXJBbGxDYWNoZSgpIHsKICAgICAgICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICAgICAgICB0aGlzLiRjb25maXJtKCfmuIXpmaTnvJPlrZjkvJrlr7zoh7TnlKjmiLfpnIDopoHph43mlrDnmbvlvZXvvIzmmK/lkKbnu6fnu60/JywgJ+aPkOekuicsIHsKICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgICAgdGhpcy4kYXBpLnBvc3QoInJlbW92ZUNhY2hlIikudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuJG1lc3NhZ2Uuc3VjY2Vzcygi5riF56m65oiQ5YqfISIpCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC4kbWVzc2FnZS5lcnJvcihyZXMubXNnKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgY29uZkNoYW5nZShlKSB7CiAgICAgICAgICAgIGxldCBwb3N0RGF0YSA9IHsKICAgICAgICAgICAgICAgIGNvbmZpZzogSlNPTi5zdHJpbmdpZnkodGhpcy5jb25mKQogICAgICAgICAgICB9OwogICAgICAgICAgICB0aGlzLnNhdmVDb25mKHBvc3REYXRhKQogICAgICAgIH0sCiAgICAgICAgc2F2ZUNvbmYoY29uZikgewogICAgICAgICAgICBsZXQgbG9hZGluZyA9IHRoaXMuJGJhc2VMb2FkaW5nKCLkv53lrZjkuK0uLi4iLDEpOwoKICAgICAgICAgICAgdGhpcy4kYXBpLnBvc3QoImNvbXBhbnkvY29uZiIsIGNvbmYpLnRoZW4ocmV0ID0+IHsKICAgICAgICAgICAgICAgIGxvYWRpbmcuY2xvc2UoKTsKCiAgICAgICAgICAgICAgICBpZiAocmV0LmNvZGUgPT09IDIwMCkKICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MocmV0Lm1zZyk7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXQubXNnKTsKICAgICAgICAgICAgfSkuY2F0Y2goZXJyPT57CiAgICAgICAgICAgICAgICBsb2FkaW5nLmNsb3NlKCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKCgogICAgfQp9Cg=="},{"version":3,"sources":["config.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA","file":"config.vue","sourceRoot":"src/views/conf","sourcesContent":["<template>\r\n    <div style=\"max-width: 1000px;margin: auto\">\r\n        <!--    客服配置    -->\r\n        <el-card class=\"box-card\">\r\n            <div slot=\"header\" class=\"clearfix\"><span>店铺系统配置</span>\r\n            </div>\r\n            <el-form ref=\"form\" :model=\"conf\" label-width=\"180px\">\r\n                <el-form-item>\r\n                    <el-button type=\"primary\" @click=\"clearAllCache\">清空系统缓存</el-button>\r\n                </el-form-item>\r\n\r\n                <el-form-item label=\"前端页面链接\" prop=\"orderRebate\">\r\n                    <el-input v-model=\"conf.frontUrl\" placeholder=\"前端页面链接\">\r\n                        <template slot=\"append\">\r\n                            <div @click=\"confChange\">保存</div>\r\n                        </template>\r\n                    </el-input>\r\n                </el-form-item>\r\n\r\n                <el-form-item label=\"分类页展示类型\" prop=\"integral\">\r\n                    <div>\r\n                        <el-radio @change=\"confChange\" v-model=\"conf.indexPageType\" label=\"categoryWithProduct\">\r\n                            分类+产品模式\r\n                        </el-radio>\r\n                        <el-radio @change=\"confChange\" v-model=\"conf.indexPageType\" label=\"categoryWithChild\">\r\n                            上级分类+下级分类模式\r\n                        </el-radio>\r\n                    </div>\r\n                    <div style=\"font-size: 12px;padding: 0 10px\">分类+产品模式：将直接把分类与产品列出（默认模式）</div>\r\n                    <div style=\"font-size: 12px;padding: 0 10px\">上级分类+下级分类模式：查出上级分类与下级分类</div>\r\n                </el-form-item>\r\n                <el-form-item label=\"自动提现\" prop=\"integral\">\r\n                    <el-switch v-model=\"conf.autoTX\" @change=\"confChange\"/>\r\n                    <span style=\"font-size: 12px;padding: 0 10px\">开启自动提现后，有付款项时，平台将自动付款到微信用户</span>\r\n                </el-form-item>\r\n\r\n                <el-form-item label=\"用户实名\" prop=\"integral\">\r\n                    <el-switch v-model=\"conf.realName\" @change=\"confChange\"/>\r\n                    <span style=\"font-size: 12px;padding: 0 10px\">开启用户实名后，用户消费只能在实名认证之后</span>\r\n                </el-form-item>\r\n                <!--        <el-form-item label=\"开放商户申请\" prop=\"integral\" v-if=\"vip['branchCompany']\">-->\r\n                <!--          <el-switch v-model=\"conf.shopApply\"/>-->\r\n                <!--          <span style=\"font-size: 12px;padding: 0 10px\">开启后将允许商户在应用端申请进驻</span>-->\r\n                <!--        </el-form-item>-->\r\n            </el-form>\r\n        </el-card>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import Vue from 'vue';\r\n\r\n    Vue.filter(\"roleRebateText\", function (val) {\r\n        let _arr = JSON.parse(val);\r\n        let _str = [];\r\n        if (Array.isArray(_arr)) {\r\n            _arr.forEach((item) => {\r\n                _str.push(item.lv + \"级提成: \" + item.rebate)\r\n            })\r\n        }\r\n        return _str.join(\"；\")\r\n    });\r\n    export default {\r\n        name: \"config\",\r\n        data() {\r\n            return {\r\n                isUse: true,\r\n                isUseText: '已启用',\r\n                conf: {\r\n                    frontUrl: '',\r\n                    indexPageType: '',\r\n                    realName: false,\r\n                    autoTX: false,\r\n                    shopApply: false,\r\n                },\r\n                vip: this.$store.state.shop.vip\r\n            }\r\n        },\r\n        created() {\r\n            this.$api.get(\"company/conf\").then(res => {\r\n                if (res.code === 200) {\r\n                    this.conf = JSON.parse(res.data.config) || {};\r\n                }\r\n            });\r\n        },\r\n        methods: {\r\n            clearAllCache() {\r\n                let that = this;\r\n                this.$confirm('清除缓存会导致用户需要重新登录，是否继续?', '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    this.$api.post(\"removeCache\").then(res => {\r\n                        if (res.code === 200) {\r\n                            that.$message.success(\"清空成功!\")\r\n                        } else {\r\n                            that.$message.error(res.msg)\r\n                        }\r\n                    })\r\n                });\r\n            },\r\n            confChange(e) {\r\n                let postData = {\r\n                    config: JSON.stringify(this.conf)\r\n                };\r\n                this.saveConf(postData)\r\n            },\r\n            saveConf(conf) {\r\n                let loading = this.$baseLoading(\"保存中...\",1);\r\n\r\n                this.$api.post(\"company/conf\", conf).then(ret => {\r\n                    loading.close();\r\n\r\n                    if (ret.code === 200)\r\n                        this.$message.success(ret.msg);\r\n                    else\r\n                        this.$message.error(ret.msg);\r\n                }).catch(err=>{\r\n                    loading.close();\r\n                })\r\n            },\r\n\r\n\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .el-card {\r\n        margin-bottom: 10px;\r\n    }\r\n\r\n    .el-input {\r\n        margin-bottom: 10px;\r\n    }\r\n\r\n    .el-button {\r\n        float: right;\r\n        margin: 0 10% 10px;\r\n    }\r\n\r\n    >>> .el-card__body {\r\n        padding: 20px 100px 20px 60px;\r\n    }\r\n</style>\r\n"]}]}